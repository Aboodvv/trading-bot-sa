# ๐ฆ ุฏููู ูุธุงู ุงูุจุงูุงุช ูุงูุงุดุชุฑุงูุงุช
# Subscription & Plans System Guide

## ๐ฏ ูุธุฑุฉ ุนุงูุฉ

ุชู ุฅุถุงูุฉ ูุธุงู ุจุงูุงุช ุดูุฑูุฉ ุงุญุชุฑุงูู ูุน 3 ูุณุชููุงุช:

### ๐ ุจุงูุฉ ูุฌุงููุฉ (Free Plan)
- **ุงูุณุนุฑ**: ูุฌุงูุงู
- **ุงููุฏุฉ**: ุดูุฑ ูุงุญุฏ (ูุงุจู ููุชุฌุฏูุฏ)
- **ุงููููุฒุงุช**:
  - 3 ุตููุงุช ููููุงู ููุท
  - 2 ุตููุฉ ููุชูุญุฉ ูู ููุณ ุงูููุช
  - ุญุฏ ุฃูุตู $500 ููู ุตููุฉ
  - ูุคุดุฑุงู ูููุงู ููุท (RSI, SMA)
  - 5 ุชุญูููุงุช ููููุงู
  - โ ุจุฏูู ุฅุดุนุงุฑุงุช ูุงุชุณุงุจ
  - โ ุจุฏูู ุชุฏุงูู ุชููุงุฆู
  - โ ุจุฏูู ุฑุณูู ุจูุงููุฉ ูุชูุฏูุฉ
  - ุฏุนู ููู ุฃุณุงุณู

### ๐ ุจุงูุฉ ูุถูุฉ (Silver Plan) - $250/ุดูุฑ
- **ุงูุณุนุฑ**: $250 ุดูุฑูุงู
- **ุงููุฏุฉ**: 30 ููู
- **ุงููููุฒุงุช**:
  - 15 ุตููุฉ ููููุงู
  - 5 ุตููุงุช ููุชูุญุฉ ูู ููุณ ุงูููุช
  - ุญุฏ ุฃูุตู $5,000 ููู ุตููุฉ
  - 5 ูุคุดุฑุงุช ูููุฉ (RSI, MACD, SMA, EMA, Bollinger)
  - 50 ุชุญููู ููููุงู
  - โ ุฅุดุนุงุฑุงุช ูุงุชุณุงุจ
  - โ ุชุฏุงูู ุชููุงุฆู
  - โ ุฑุณูู ุจูุงููุฉ ูุชูุฏูุฉ
  - ุฏุนู ููู ุฃููููุฉ

### ๐ ุจุงูุฉ ุฐูุจูุฉ (Gold Plan) - $500/ุดูุฑ
- **ุงูุณุนุฑ**: $500 ุดูุฑูุงู
- **ุงููุฏุฉ**: 30 ููู
- **ุงููููุฒุงุช**:
  - ุตููุงุช ููููุฉ ุบูุฑ ูุญุฏูุฏุฉ
  - 20 ุตููุฉ ููุชูุญุฉ ูู ููุณ ุงูููุช
  - ุญุฏ ุฃูุตู $50,000 ููู ุตููุฉ
  - ุฌููุน ุงููุคุดุฑุงุช ุงููููุฉ
  - ุชุญูููุงุช ุบูุฑ ูุญุฏูุฏุฉ
  - โ ุฅุดุนุงุฑุงุช ูุงุชุณุงุจ
  - โ ุชุฏุงูู ุชููุงุฆู
  - โ ุฑุณูู ุจูุงููุฉ ูุชูุฏูุฉ
  - โ ุชููุนุงุช AI
  - โ ุงุณุชุฑุงุชูุฌูุงุช ูุฎุตุตุฉ
  - ุฏุนู ููู VIP

---

## ๐ ุงููููุงุช ุงููุถุงูุฉ

### 1. `subscription_system.py` (ุงููุธุงู ุงูุฃุณุงุณู)
**ุงููุธููุฉ**: ุฅุฏุงุฑุฉ ุงูุจุงูุงุช ูุงูุงุดุชุฑุงูุงุช ูุงูุญุฏูุฏ

**ุงูููุงุณุงุช ุงูุฑุฆูุณูุฉ**:
```python
class SubscriptionPlan(Enum):
    FREE = "free"
    SILVER = "silver"
    GOLD = "gold"

class SubscriptionManager:
    # ุฌููุน ูุธุงุฆู ุฅุฏุงุฑุฉ ุงูุงุดุชุฑุงูุงุช
```

**ุงูุฏูุงู ุงูุฑุฆูุณูุฉ**:

1. **`create_subscription(user_id, plan_type, payment_method, transaction_id)`**
   - ุฅูุดุงุก ุงุดุชุฑุงู ุฌุฏูุฏ ูููุณุชุฎุฏู
   - ุฅูุบุงุก ุงูุงุดุชุฑุงูุงุช ุงูุณุงุจูุฉ ุชููุงุฆูุงู
   - ุชุณุฌูู ุงูุฏูุนุฉ ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช
   
2. **`get_user_subscription(user_id)`**
   - ุงูุญุตูู ุนูู ุงุดุชุฑุงู ุงููุณุชุฎุฏู ุงูุญุงูู
   - ุงูุชุญูู ุงูุชููุงุฆู ูู ุงูุชูุงุก ุงูุตูุงุญูุฉ
   - ุฅุฑุฌุงุน ุงููููุฒุงุช ุงููุชุงุญุฉ
   
3. **`check_feature_limit(user_id, feature_name)`**
   - ุงูุชุญูู ูู ุญุฏ ุงุณุชุฎุฏุงู ููุฒุฉ ูุนููุฉ
   - ุญุณุงุจ ุงููุชุจูู ูู ุงูุญุฏ ุงููููู
   
4. **`can_trade(user_id)`**
   - ุงูุชุญูู ูู ุฅููุงููุฉ ูุชุญ ุตููุฉ ุฌุฏูุฏุฉ
   - ููุญุต:
     * ุงูุญุฏ ุงููููู ููุตููุงุช
     * ุนุฏุฏ ุงูุตููุงุช ุงูููุชูุญุฉ
     * ุญุงูุฉ ุงูุงุดุชุฑุงู
   
5. **`expire_subscription(user_id)`**
   - ุฅููุงุก ุงูุงุดุชุฑุงูุงุช ุงูููุชููุฉ
   - ุฅุฑุฌุงุน ุงููุณุชุฎุฏู ููุจุงูุฉ ุงููุฌุงููุฉ ุชููุงุฆูุงู

**ูุงุนุฏุฉ ุงูุจูุงูุงุช**:
```sql
-- ุฌุฏูู ุงูุงุดุชุฑุงูุงุช
subscriptions (
    id, user_id, plan_type, start_date, end_date, 
    status, auto_renew, created_at
)

-- ุฌุฏูู ุงูุฏูุนุงุช
subscription_payments (
    id, user_id, subscription_id, amount, 
    payment_method, payment_status, transaction_id, created_at
)

-- ุฌุฏูู ุงุณุชุฎุฏุงู ุงููููุฒุงุช
feature_usage (
    id, user_id, feature_name, usage_count, 
    usage_date, created_at
)
```

### 2. `subscription_pages.py` (ุตูุญุงุช HTML)
**ุงููุธููุฉ**: ูุงุฌูุงุช ุงููุณุชุฎุฏู ูุนุฑุถ ูุฅุฏุงุฑุฉ ุงูุจุงูุงุช

**ุงูุตูุญุงุช**:

1. **`PLANS_PAGE`** - ุตูุญุฉ ุนุฑุถ ุงูุจุงูุงุช
   - ุนุฑุถ ุฌููุน ุงูุจุงูุงุช ุจุชุตููู ุงุญุชุฑุงูู
   - ุฌุฏูู ููุงุฑูุฉ ุชูุตููู
   - ุฃุฒุฑุงุฑ ุงุดุชุฑุงู ููุฑูุฉ
   - ุชุณููุท ุงูุถูุก ุนูู ุงูุจุงูุฉ ุงูุญุงููุฉ
   
2. **`SUBSCRIPTION_STATUS_PAGE`** - ุตูุญุฉ ุญุงูุฉ ุงูุงุดุชุฑุงู
   - ุนุฑุถ ุชูุงุตูู ุงูุงุดุชุฑุงู ุงูุญุงูู
   - ุงูุฃูุงู ุงููุชุจููุฉ
   - ุงููููุฒุงุช ุงููุชุงุญุฉ
   - ุชุญุฐูุฑุงุช ุงูุงูุชูุงุก

---

## ๐ ุงูุชูุงูู ูุน web_app.py

### Routes ุงููุถุงูุฉ:

```python
# 1. ุตูุญุฉ ุนุฑุถ ุงูุจุงูุงุช
@app.route('/plans')
def plans_page()

# 2. ุตูุญุฉ ุญุงูุฉ ุงูุงุดุชุฑุงู
@app.route('/subscription')
def subscription_status_page()

# 3. API: ุงูุญุตูู ุนูู ุงูุงุดุชุฑุงู ุงูุญุงูู
@app.route('/api/subscription/current', methods=['GET'])
def get_current_subscription()

# 4. API: ุงูุงุดุชุฑุงู ูู ุจุงูุฉ ุฌุฏูุฏุฉ
@app.route('/api/subscription/subscribe', methods=['POST'])
def subscribe_to_plan()

# 5. API: ุงูุชุญูู ูู ุญุฏ ููุฒุฉ
@app.route('/api/subscription/check_limit/<feature_name>', methods=['GET'])
def check_feature_limit(feature_name)

# 6. API: ุงูุชุญูู ูู ุฅููุงููุฉ ุงูุชุฏุงูู
@app.route('/api/subscription/can_trade', methods=['GET'])
def check_can_trade()
```

### JavaScript ุงููุถุงู:

```javascript
// ุชุญููู ูุนูููุงุช ุงูุงุดุชุฑุงู ุนูุฏ ูุชุญ ุงูุตูุญุฉ
async function loadSubscriptionInfo()

// ุงูุชุญูู ูุจู ูุชุญ ุตููุฉ ุฌุฏูุฏุฉ
async function checkCanTrade()

// ุชุณุฌูู ุงูุฎุฑูุฌ
async function logout()
```

---

## ๐ฎ ููููุฉ ุงูุงุณุชุฎุฏุงู

### 1. ูููุณุชุฎุฏู ุงูุนุงุฏู:

#### ุงูุชุณุฌูู ูุงูุงุดุชุฑุงู:
```
1. ุงูุชูู ุฅูู http://127.0.0.1:5000
2. ุณุฌู ุญุณุงุจ ุฌุฏูุฏ (ุงูุชุฑุงุถูุงู: ุจุงูุฉ ูุฌุงููุฉ)
3. ุงุถุบุท "ุชุฑููุฉ ุงูุจุงูุฉ" ูู ุงูุฏุงุดุจูุฑุฏ
4. ุงุฎุชุฑ ุงูุจุงูุฉ ุงูููุงุณุจุฉ
5. ุฃุฏุฎู ูุนูููุงุช ุงูุฏูุน
6. ุงุณุชูุชุน ุจุงููููุฒุงุช!
```

#### ุนุฑุถ ุญุงูุฉ ุงูุงุดุชุฑุงู:
```
1. ุงุถุบุท "ุงุดุชุฑุงูู" ูู ุงูุฏุงุดุจูุฑุฏ
2. ุดุงูุฏ ุชูุงุตูู ุจุงูุชู ุงูุญุงููุฉ
3. ุงูุฃูุงู ุงููุชุจููุฉ
4. ุงููููุฒุงุช ุงููุชุงุญุฉ
```

### 2. ูููุทูุฑ (ุงูููุฏ):

#### ุฅูุดุงุก ุงุดุชุฑุงู ุจุฑูุฌูุงู:
```python
from subscription_system import subscription_manager

# ุงูุงุดุชุฑุงู ูู ุงูุจุงูุฉ ุงููุถูุฉ
result = subscription_manager.create_subscription(
    user_id=1,
    plan_type='silver',
    payment_method='card',
    transaction_id='TXN_12345'
)

print(result)
# {'success': True, 'message': 'ุชู ุงูุงุดุชุฑุงู ูู ุจุงูุฉ ูุถูุฉ ุจูุฌุงุญ', 
#  'subscription_id': 1, 'end_date': '2025-12-07'}
```

#### ุงูุชุญูู ูู ุญุฏูุฏ ุงููุณุชุฎุฏู:
```python
# ุงูุชุญูู ูู ุฅููุงููุฉ ุงูุชุฏุงูู
can_trade = subscription_manager.can_trade(user_id=1)

if can_trade['can_trade']:
    # ุงููุณุชุฎุฏู ููููู ุงูุชุฏุงูู
    print("ุงูุชุญ ุงูุตููุฉ")
else:
    # ุงููุณุชุฎุฏู ูุตู ููุญุฏ
    print(can_trade['reason'])
    print(can_trade['upgrade_suggestion'])
```

#### ุงูุญุตูู ุนูู ูุนูููุงุช ุงูุงุดุชุฑุงู:
```python
subscription = subscription_manager.get_user_subscription(user_id=1)

print(f"ุงูุจุงูุฉ: {subscription['plan_name']}")
print(f"ุงูุญุงูุฉ: {subscription['status']}")
print(f"ุงูุฃูุงู ุงููุชุจููุฉ: {subscription.get('days_remaining', 'N/A')}")
print(f"ุงูุตููุงุช ุงูููููุฉ: {subscription['features']['max_trades_per_day']}")
```

#### ุงูุชุญูู ูู ููุฒุฉ ูุนููุฉ:
```python
# ูุซุงู: ุงูุชุญูู ูู ุญุฏ ุงูุชุญูููุงุช ุงูููููุฉ
limit = subscription_manager.check_feature_limit(user_id=1, 'daily_analysis')

if limit['allowed']:
    # ุชูููุฐ ุงูุชุญููู
    analyze_stock()
    # ุฒูุงุฏุฉ ุงูุนุฏุงุฏ
    subscription_manager.increment_feature_usage(user_id=1, 'daily_analysis')
else:
    print(limit['message'])
```

---

## ๐ ุงูุชุฌุฏูุฏ ุงูุชููุงุฆู

### ุงูุขููุฉ:
1. ุนูุฏ ุงูุชูุงุก ุงูุงุดุชุฑุงูุ ูุชู ุชููุงุฆูุงู:
   - ุชุบููุฑ status ุฅูู 'expired'
   - ุฅุฑุฌุงุน ุงููุณุชุฎุฏู ููุจุงูุฉ ุงููุฌุงููุฉ
   - ุฅููุงู ุงููุตูู ูููููุฒุงุช ุงููุฏููุนุฉ

2. ุงูุชุญูู ูุญุฏุซ ุนูุฏ:
   - ูู ุงุณุชุฏุนุงุก ูู `get_user_subscription()`
   - ูุญุงููุฉ ุงุณุชุฎุฏุงู ุฃู ููุฒุฉ
   - ุชุณุฌูู ุงูุฏุฎูู

### ุชูุนูู ุงูุชุฌุฏูุฏ ุงูุชููุงุฆู:
```python
# ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช
subscription.auto_renew = True

# ูููู ุฅุถุงูุฉ cronjob ูุชุฌุฏูุฏ ุงูุงุดุชุฑุงูุงุช ููููุงู
# (ูุชุทูุจ ุชูุงูู ูุน ูุธุงู ุฏูุน ุญูููู)
```

---

## ๐ ูุซุงู ุนูู ุณููุงุฑูู ูุงูู

### ุงููุณุชุฎุฏู ุงูุฌุฏูุฏ:
```python
# 1. ุงูุชุณุฌูู
user_db.create_user(
    username='ali_trader',
    email='ali@example.com',
    password='secure123',
    full_name='ุนูู ุฃุญูุฏ',
    phone='+966501234567',
    whatsapp_number='+966501234567'
)
# ุงูุจุงูุฉ ุงูุงูุชุฑุงุถูุฉ: free

# 2. ุชุณุฌูู ุงูุฏุฎูู
login_result = user_db.login_user('ali_trader', 'secure123')
user_id = 1

# 3. ุงูุชุญูู ูู ุงูุจุงูุฉ ุงูุญุงููุฉ
sub = subscription_manager.get_user_subscription(user_id)
print(sub['plan_type'])  # 'free'
print(sub['features']['max_trades_per_day'])  # 3

# 4. ูุญุงููุฉ ุงูุชุฏุงูู
for i in range(5):
    can_trade = subscription_manager.can_trade(user_id)
    
    if can_trade['can_trade']:
        print(f"ุตููุฉ {i+1}: ุชู ุงููุชุญ โ")
        # ูุชุญ ุงูุตููุฉ
        subscription_manager.increment_feature_usage(user_id, 'daily_trades')
    else:
        print(f"ุตููุฉ {i+1}: {can_trade['reason']} โ")
        # ุนุฑุถ ุฑุณุงูุฉ ุชุฑููุฉ ุงูุจุงูุฉ

# ุงููุชูุฌุฉ:
# ุตููุฉ 1: ุชู ุงููุชุญ โ
# ุตููุฉ 2: ุชู ุงููุชุญ โ
# ุตููุฉ 3: ุชู ุงููุชุญ โ
# ุตููุฉ 4: ูุตูุช ููุญุฏ ุงูุฃูุตู ูู ุงูุตููุงุช ุงูููููุฉ โ
# ุตููุฉ 5: ูุตูุช ููุญุฏ ุงูุฃูุตู ูู ุงูุตููุงุช ุงูููููุฉ โ

# 5. ุชุฑููุฉ ุงูุจุงูุฉ
upgrade = subscription_manager.create_subscription(
    user_id=user_id,
    plan_type='silver',
    payment_method='card',
    transaction_id='TXN_SILVER_001'
)

# 6. ุงูุขู ููููู ุงูุชุฏุงูู 15 ุตููุฉ ููููุงู
sub = subscription_manager.get_user_subscription(user_id)
print(sub['plan_type'])  # 'silver'
print(sub['features']['max_trades_per_day'])  # 15
print(sub['features']['whatsapp_notifications'])  # True
```

---

## โ๏ธ ููุงุญุธุงุช ูููุฉ

### 1. ุนุฏู ุงูุณุฏุงุฏ:
- ุนูุฏ ุงูุชูุงุก ุงูุงุดุชุฑุงู ุงููุฏููุนุ ูุชููู ุงููุตูู ูููููุฒุงุช **ููุฑุงู**
- ูุชู ุฅุฑุฌุงุน ุงููุณุชุฎุฏู ููุจุงูุฉ ุงููุฌุงููุฉ ุชููุงุฆูุงู
- ูุชู ุงูุงุญุชูุงุธ ุจุจูุงูุงุช ุงููุณุชุฎุฏู (ุงูุตููุงุชุ ุงูุฑุตูุฏุ ุงูุฅุนุฏุงุฏุงุช)

### 2. ุงูุชุญุฐูุฑุงุช:
- ุชุญุฐูุฑ ุชููุงุฆู ูุจู 7 ุฃูุงู ูู ุงูุชูุงุก ุงูุงุดุชุฑุงู
- ูุธูุฑ ูู ุงูุฏุงุดุจูุฑุฏ ูุตูุญุฉ ุงูุงุดุชุฑุงู
- ูููู ุฅุฑุณุงู ุฅุดุนุงุฑ ูุงุชุณุงุจ (ุฅุฐุง ูุงู ููุนู)

### 3. ุงูุญุฏูุฏ ุงูููููุฉ:
- ูุชู ุฅุนุงุฏุฉ ุชุนููู ุงูุญุฏูุฏ ูู 24 ุณุงุนุฉ (ููุชุตู ุงูููู UTC)
- ุชูุญุณุจ ุจูุงุกู ุนูู `usage_date` ูู ุฌุฏูู `feature_usage`

### 4. ุงูุฏูุน:
- ูุชูุงูู ูุน ูุธุงู ุงูุฏูุน ุงูููุฌูุฏ (`payment_system.py`)
- ูุฏุนู ุจุทุงูุงุช ุงูุงุฆุชูุงู ูุงูุชุญููู ุงูุจููู
- ูุชู ุชุณุฌูู ุฌููุน ุงููุนุงููุงุช ูู `subscription_payments`

---

## ๐งช ุงุฎุชุจุงุฑ ุงููุธุงู

### ุงุฎุชุจุงุฑ ุณุฑูุน:
```python
# ุชุดุบูู ูุฐุง ุงูููุฏ ููุงุฎุชุจุงุฑ
from subscription_system import subscription_manager
from user_system import user_db

# 1. ุฅูุดุงุก ูุณุชุฎุฏู ุชุฌุฑูุจู
user_result = user_db.create_user(
    username='test_user',
    email='test@example.com',
    password='test123',
    full_name='Test User',
    phone='+966500000000'
)

# 2. ุชุณุฌูู ุงูุฏุฎูู
login = user_db.login_user('test_user', 'test123')

# 3. ุงูุชุญูู ูู ุงูุจุงูุฉ ุงูุงูุชุฑุงุถูุฉ
sub = subscription_manager.get_user_subscription(1)
print(f"ุงูุจุงูุฉ: {sub['plan_name']}")  # ุจุงูุฉ ูุฌุงููุฉ
print(f"ุงูุญุฏ ุงููููู: {sub['features']['max_trades_per_day']}")  # 3

# 4. ุงูุงุดุชุฑุงู ูู ุจุงูุฉ ูุฏููุนุฉ
upgrade = subscription_manager.create_subscription(
    user_id=1,
    plan_type='gold',
    payment_method='test'
)
print(upgrade)

# 5. ุงูุชุญูู ูู ุงูุชุฑููุฉ
sub = subscription_manager.get_user_subscription(1)
print(f"ุงูุจุงูุฉ ุงูุฌุฏูุฏุฉ: {sub['plan_name']}")  # ุจุงูุฉ ุฐูุจูุฉ
print(f"ุงูุญุฏ ุงูุฌุฏูุฏ: {sub['features']['max_trades_per_day']}")  # 999 (ุบูุฑ ูุญุฏูุฏ)
print(f"ุชูุชูู ูู: {sub.get('end_date', 'N/A')}")

print("\nโ ุงูุงุฎุชุจุงุฑ ูุฌุญ!")
```

---

## ๐ ุงูุชูุณุนุงุช ุงููุณุชูุจููุฉ

### ูููู ุฅุถุงูุฉ:
1. **ุจุงูุงุช ุฑุจุน ุณูููุฉ/ุณูููุฉ** ุจุฎุตู
2. **ูุชุฑุฉ ุชุฌุฑูุจูุฉ ูุฌุงููุฉ** (7 ุฃูุงู) ููุจุงูุงุช ุงููุฏููุนุฉ
3. **ููุงุท ููุงุก** (Loyalty Points)
4. **ุจุฑูุงูุฌ ุฅุญุงูุฉ** (Referral)
5. **ุชุฎููุถุงุช ููุณููุฉ**
6. **ุจุงูุงุช ูุฎุตุตุฉ ููุดุฑูุงุช**

---

## ๐ ุงูุฏุนู

ุฅุฐุง ูุงู ูุฏูู ุฃุณุฆูุฉ ุฃู ุชุญุชุงุฌ ูุณุงุนุฏุฉ:
- ุฑุงุฌุน ูุฐุง ุงูููู ุฃููุงู
- ุชุญูู ูู `USER_SYSTEM_GUIDE.md` ููุธุงู ุงููุณุชุฎุฏููู
- ุชุญูู ูู `PAYMENT_SYSTEM_GUIDE.md` ููุธุงู ุงูุฏูุน

---

**ุชู ุงูุชุทููุฑ ุจูุงุณุทุฉ**: Trading Bot AI System  
**ุงูุชุงุฑูุฎ**: ููููุจุฑ 2025  
**ุงูุฅุตุฏุงุฑ**: 1.0
